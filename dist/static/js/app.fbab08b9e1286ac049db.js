webpackJsonp([1],{"9M+g":function(t,e){},"E+YI":function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("/5sW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},o,!1,function(t){n("gsu9")},null,null).exports,c=n("/ocq"),l=n("oqQY"),r=n.n(l),s=n("SBsU"),d=n.n(s),u={name:"Home",data:function(){return{qrPath:"/static/pic/qr.jpeg",logoPath:"/static/pic/logo.jpg",canDownload:!1,value:50,photo:null,selected:"brightness",options:[{value:"brightness",text:"亮度",num:50},{value:"contrast",text:"对比度",num:50}],timeoutId:null,loading:!1}},mounted:function(){var t=document.getElementById("canvas"),e=t.getContext("2d"),n=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),a=t.width,o=t.height;t.width=a*n,t.height=o*n,t.style.width=a+"px",t.style.height=o+"px",e.scale(n,n),this.drawRound(e),this.drawLogo(e)},methods:{onSelectChanged:function(t){this.value=this.options.filter(function(e){return e.value===t})[0].num},change:function(){var t=this;this.timeoutId&&(clearTimeout(this.timeoutId),this.loading=!1),this.loading=!0,this.timeoutId=setTimeout(function(){d.a.read(t.photo.src).then(function(e){var n=t.value/100-.5;"brightness"===t.selected?e.brightness(n).getBase64Async(d.a.MIME_PNG).then(function(e){t.photo.src=e}):e.contrast(n).getBase64Async(d.a.MIME_PNG).then(function(e){t.photo.src=e}),t.loading=!1,t.options.filter(function(e){return e.value===t.selected})[0].num=t.value}).catch(function(e){console.error(e),t.loading=!1})},500)},download:function(){var t=this,e=document.getElementById("canvas").toDataURL("image/jpeg"),n=document.getElementById("canvas").getContext("2d");n.clearRect(0,0,300,300),n.fillStyle="#ffffff",n.fillRect(0,0,300,300),n.fill();var a=new Image;a.onload=function(){var e=t.getCanvasInfo(a,300,300),o=e.dx,i=e.dy,c=e.dWidth,l=e.dHeight;n.drawImage(a,-o,-i,c,l);var s=document.getElementById("a");s.href=document.getElementById("canvas").toDataURL("image/png"),s.download=r()().unix()+".png",s.click()},a.src=e},drawBack:function(t){t.fillStyle="#ffffff",t.fillRect(0,0,300,300)},drawRound:function(t){t.fillStyle="#ececec",t.arc(150,145,130,0,360),t.fill()},drawLogo:function(t){t.globalCompositeOperation="source-over";var e=new Image;e.onload=function(){t.drawImage(e,250,250,37,37)},e.src=this.qrPath;var n=new Image;n.onload=function(){t.drawImage(n,10,260,n.width/7,n.height/7)},n.src=this.logoPath},open:function(){document.getElementById("takepicture").click()},setImagePreview:function(t){var e=(window.URL||window.webkitURL).createObjectURL(t.target.files[0]);this.reDrawPhoto(e)},reDrawPhoto:function(t){var e=this;this.photo=new Image,this.photo.onload=function(){var t=document.getElementById("canvas").getContext("2d");t.clearRect(0,0,300,300),e.drawRound(t),t.globalCompositeOperation="source-atop";var n=e.getCanvasInfo(e.photo,300,300),a=n.dx,o=n.dy,i=n.dWidth,c=n.dHeight;t.drawImage(e.photo,-a,-o,i,c),e.drawLogo(t),e.canDownload=!0},this.photo.src=t},getCanvasInfo:function(t,e,n){var a=t.width,o=t.height,i=0,c=0;return a>o?(c=n,(i=a/(o/n))<e&&(i=e,c=o/(a/e))):(i=e,(c=o/(a/e))<n&&(c=n,i=a/(o/n))),{dx:(i-e)/2,dy:(c-n)/2,dWidth:i,dHeight:c}}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",[t._v("无境书茶2019日历工具")]),t._v(" "),n("canvas",{attrs:{id:"canvas",width:"300",height:"300"}}),t._v(" "),n("div",{staticStyle:{position:"fixed",top:"48vh",left:"48vw"},style:t.loading?"display: block;":"display: none;"},[n("b-spinner",{attrs:{variant:"primary",label:"Spinning"}})],1),t._v(" "),n("div",{staticStyle:{padding:"10vw"}},[n("b-button",{attrs:{disabled:!t.canDownload,block:"",variant:"success"},on:{click:t.download}},[t._v("下载图片")]),t._v(" "),n("b-button",{attrs:{block:"",variant:"primary"},on:{click:t.open}},[t._v("获取图片")]),t._v(" "),n("input",{staticStyle:{display:"none"},attrs:{id:"takepicture",type:"file",accept:"image/*"},on:{change:t.setImagePreview}}),t._v(" "),n("a",{staticStyle:{display:"none"},attrs:{id:"a"}}),t._v(" "),n("div",{staticStyle:{"margin-top":"10px"},style:t.canDownload?"display: block":"display: none"},[n("b-form-select",{attrs:{options:t.options},on:{change:t.onSelectChanged},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),t._v(" "),n("vue-slider",{staticStyle:{"margin-top":"20px"},on:{change:t.change},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1)])},staticRenderFns:[]};var h=n("VU/8")(u,g,!1,function(t){n("E+YI")},"data-v-2f1008f8",null).exports;a.default.use(c.a);var f=new c.a({routes:[{path:"/",name:"Home",component:h}],mode:"history"}),v=n("e6fC"),p=n.n(v),m=(n("Jmt5"),n("9M+g"),n("lCKi")),w=n.n(m);n("n1Sy");a.default.config.productionTip=!1,a.default.use(p.a),a.default.component("VueSlider",w.a),new a.default({el:"#app",router:f,render:function(t){return t(i)}})},gsu9:function(t,e){},n1Sy:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.fbab08b9e1286ac049db.js.map